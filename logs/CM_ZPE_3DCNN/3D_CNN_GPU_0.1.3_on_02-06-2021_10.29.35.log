2021-02-06 10:29:35,013:INFO:Starting model 3D_CNN_GPU_0.1.3_on_02-06-2021_10.29.35
2021-02-06 10:29:35,013:INFO:=================== Model info ===================
2021-02-06 10:29:35,013:INFO:Author: Michiel Jacobs
2021-02-06 10:29:35,013:INFO:Version: 0.1.3
2021-02-06 10:29:35,013:INFO:Modeltype: 3D CNN GPU
2021-02-06 10:29:35,013:INFO:Maximum heavy atoms: 20
2021-02-06 10:29:35,014:INFO:Feature: Coulomb Matrix
2021-02-06 10:29:35,014:INFO:Labels: Zero point energy
2021-02-06 10:29:35,014:INFO:DEVELOPMENT: False
2021-02-06 10:29:35,015:INFO:Platform: Linux-3.10.0-1160.2.2.el7.x86_64-x86_64-with-glibc2.2.5
2021-02-06 10:29:35,015:INFO:OS: Linux
2021-02-06 10:29:35,015:INFO:Version: #1 SMP Tue Oct 20 16:53:08 UTC 2020
2021-02-06 10:29:35,015:INFO:Processor: x86_64
2021-02-06 10:29:35,015:INFO:============== Step 1: loading data ==============
2021-02-06 10:29:42,062:INFO:Data loaded
2021-02-06 10:29:42,062:INFO:============== Step 2: data preprocessing ==============
2021-02-06 10:29:42,062:INFO:Trimming dataset...
2021-02-06 10:29:42,216:INFO:Loading arrays...
2021-02-06 10:29:43,027:INFO:Shuffeling data...
2021-02-06 10:29:43,030:INFO:Calculating maximum size of molecules...
2021-02-06 10:29:43,030:INFO:The maximumsize of molecules is 62
2021-02-06 10:29:43,030:INFO:Normalizing data...
2021-02-06 10:29:43,675:INFO:Tensorisation of the coulomb matrices...
2021-02-06 10:34:39,067:INFO:Building channels...
2021-02-06 10:34:39,113:INFO:Converting data to tf.tensors
2021-02-06 10:34:39,897:INFO:Calculating train test split...
2021-02-06 10:34:39,897:INFO:There are 10695 entries in this dataset.
2021-02-06 10:34:39,897:INFO:Split ratio set to 0.8.
2021-02-06 10:34:39,897:INFO:Trainingset contains 8556 molecules.
2021-02-06 10:34:39,897:INFO:Building train and test sets...
2021-02-06 10:34:39,901:INFO:Converting train features to array...
2021-02-06 19:47:55,149:INFO:Converting test features to array...
2021-02-06 22:05:47,721:INFO:Converting train labels to array...
2021-02-06 22:05:47,726:INFO:Converting test labels to array...
2021-02-06 22:05:47,727:INFO:============== Step 3: Model compilation ==============
2021-02-06 22:05:47,727:INFO:Building model...
2021-02-06 22:05:47,811:INFO:Model: "sequential"
2021-02-06 22:05:47,811:INFO:_________________________________________________________________
2021-02-06 22:05:47,811:INFO:Layer (type)                 Output Shape              Param #   
2021-02-06 22:05:47,811:INFO:=================================================================
2021-02-06 22:05:47,811:INFO:conv3d (Conv3D)              (None, 6, 60, 60, 64)     640       
2021-02-06 22:05:47,811:INFO:_________________________________________________________________
2021-02-06 22:05:47,811:INFO:max_pooling3d (MaxPooling3D) (None, 3, 30, 30, 64)     0         
2021-02-06 22:05:47,811:INFO:_________________________________________________________________
2021-02-06 22:05:47,811:INFO:conv3d_1 (Conv3D)            (None, 3, 28, 28, 64)     36928     
2021-02-06 22:05:47,812:INFO:_________________________________________________________________
2021-02-06 22:05:47,812:INFO:max_pooling3d_1 (MaxPooling3 (None, 1, 14, 14, 64)     0         
2021-02-06 22:05:47,812:INFO:_________________________________________________________________
2021-02-06 22:05:47,812:INFO:conv3d_2 (Conv3D)            (None, 1, 12, 12, 64)     36928     
2021-02-06 22:05:47,812:INFO:_________________________________________________________________
2021-02-06 22:05:47,812:INFO:flatten (Flatten)            (None, 9216)              0         
2021-02-06 22:05:47,812:INFO:_________________________________________________________________
2021-02-06 22:05:47,812:INFO:dropout (Dropout)            (None, 9216)              0         
2021-02-06 22:05:47,812:INFO:_________________________________________________________________
2021-02-06 22:05:47,812:INFO:dense (Dense)                (None, 32)                294944    
2021-02-06 22:05:47,812:INFO:_________________________________________________________________
2021-02-06 22:05:47,814:INFO:dense_1 (Dense)              (None, 32)                1056      
2021-02-06 22:05:47,814:INFO:_________________________________________________________________
2021-02-06 22:05:47,815:INFO:dense_2 (Dense)              (None, 1)                 33        
2021-02-06 22:05:47,815:INFO:=================================================================
2021-02-06 22:05:47,815:INFO:Total params: 370,529
2021-02-06 22:05:47,815:INFO:Trainable params: 370,529
2021-02-06 22:05:47,815:INFO:Non-trainable params: 0
2021-02-06 22:05:47,815:INFO:_________________________________________________________________
2021-02-06 22:05:47,815:INFO:Compiling the model...
2021-02-06 22:05:47,821:INFO:============== Step 4: Model training ==============
2021-02-06 22:05:47,821:INFO:Enabeling early stopping...
2021-02-06 22:05:47,821:INFO:Start training...
2021-02-06 22:14:08,955:INFO:Plotting loss...
2021-02-06 22:14:09,202:INFO:Plotting metric mean_absolute_error
2021-02-06 22:14:09,381:INFO:Plotting metric mean_squared_error
2021-02-06 22:14:09,567:INFO:============== Step 5: Model evaluation ==============
2021-02-06 22:14:09,567:INFO:Evaluating model...
2021-02-06 22:14:14,381:INFO:Test scores:
2021-02-06 22:14:14,381:INFO:{'loss': 9.06593122635968e-05,
 'mean_absolute_error': 0.006979754660278559,
 'mean_squared_error': 9.06593122635968e-05}
2021-02-06 22:14:14,381:INFO:Making test predictions...
2021-02-06 22:14:20,482:INFO:Plotting ToP plot...
2021-02-06 22:14:20,704:INFO:Plotting Error histogram plot...
2021-02-06 22:14:20,948:INFO:Plotting boxplot...
2021-02-06 22:14:21,107:INFO:============== Step 6: Saving, reporting and cleanup ==============
2021-02-06 22:14:21,107:INFO:Saving model...
2021-02-06 22:14:21,447:WARNING:From /apps/brussel/CO7/broadwell/software/TensorFlow/2.3.1-foss-2020a-Python-3.8.2/lib/python3.8/site-packages/tensorflow/python/training/tracking/tracking.py:111: Model.state_updates (from tensorflow.python.keras.engine.training) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
2021-02-06 22:14:21,452:WARNING:From /apps/brussel/CO7/broadwell/software/TensorFlow/2.3.1-foss-2020a-Python-3.8.2/lib/python3.8/site-packages/tensorflow/python/training/tracking/tracking.py:111: Layer.updates (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
2021-02-06 22:14:22,813:INFO:Assets written to: /scratch/brussel/102/vsc10255/Experimental-Reactivity-Prediction/code/models/../../models/CM_ZPE_3DCNN/3D_CNN_GPU_0.1.3_on_02-06-2021_10.29.35.tf/assets
2021-02-06 22:14:23,070:INFO:Model saved.
2021-02-06 22:14:23,071:INFO:Generating report...
2021-02-06 22:14:25,500:INFO:Page break on page 5 at y=271 for element of height 116
2021-02-06 22:14:27,295:INFO:Page break on page 10 at y=273 for element of height 5
2021-02-06 22:14:27,300:INFO:Page break on page 11 at y=273 for element of height 5
2021-02-06 22:14:27,362:INFO:Removed images
2021-02-06 22:14:27,362:INFO:Shutting down...
